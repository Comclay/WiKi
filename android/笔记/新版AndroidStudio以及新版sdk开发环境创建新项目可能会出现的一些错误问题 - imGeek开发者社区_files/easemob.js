!function(e,t){"use strict";var i,s,o,n,a,l,r=document.title,d={x:10,y:10},c={x:0,y:0},m=document.createElement("div"),u="-新消息提醒  ",y=0,p=function(e,t){var i;if(e&&t){for(var s=document.scripts,o=0,n=s.length;n>o;o++)if(s[o].src&&0<s[o].src.indexOf(e)){i=s[o].src;break}}else i=e?e:location.href;var a={};if(!i)return{str:"",json:a,domain:""};var l,r=i.indexOf("?"),d=i.indexOf("//")>-1?i.indexOf("//"):0,c=i.slice(d,i.indexOf("/",d+2)),m=i.slice(r+1).split("&");a.src=i.slice(0,r);for(var u=0,y=m.length;y>u;u++)l=m[u].split("="),a[l[0]]=l.length>1?decodeURIComponent(l[1]):"";return{str:i,json:a,domain:c}},f=p("easemob.js",!0);f.json.hide="false"===f.json.hide?!1:f.json.hide,f.json.sat="false"===f.json.sat?!1:f.json.sat;var h=function(){i.listenToIframe(function(e){var t,i,o,n="新消息提醒";if(e.indexOf("setuser")>-1&&(t=e.split("@").length>0?e.split("@")[1]:"",e=e.split("@").length>0?e.split("@")[0]:""),e.indexOf("notify")>-1&&(n=e.slice(6),e="notify"),e.indexOf("dragready")>-1){var a=e.slice(9);c.x=isNaN(Number(a.split("&")[0]))?0:Number(a.split("&")[0]),c.y=isNaN(Number(a.split("&")[1]))?0:Number(a.split("&")[1]),e="dragready"}if(e.indexOf("setchannel")>-1&&(i=e.split("@").length>0?e.split("@")[1]:"",e=e.split("@").length>0?e.split("@")[0]:""),e.indexOf("setgroupuser")>-1){var l=e.indexOf("@emgroupuser@");t=e.slice(13,l),o=e.slice(l+13),e="setgroupuser"}switch(e){case"msgPrompt":var p,h=(r+u).split("");clearInterval(y),y=setInterval(function(){p=h.shift(),document.title=p+Array.prototype.join.call(h,""),h.push(p)},360);break;case"notify":T(f.domain+"/webim/static/img/notify.png","新消息",n);break;case"recoveryTitle":clearInterval(y),document.title=r;break;case"showChat":s.style.width="400px",s.style.height="500px",s.style.visibility="visible",s.style.right=d.x+"px",s.style.bottom=d.y+"px",s.style.cssText+="box-shadow: 0 4px 8px rgba(0,0,0,.2);border-radius: 4px;border: 1px solid #ccc\\9;";break;case"minChat":v&&clearTimeout(v),s.style.boxShadow="none",s.style.borderRadius="4px;",s.style.left="auto",s.style.right="-5px",s.style.top="auto",s.style.bottom="10px",s.style.border="none",f.json.hide?(s.style.visibility="hidden",s.style.width="12px",s.style.height="12px"):(s.style.height="37px",s.style.width="104px");break;case"setuser":Emc.setcookie("emKefuUser",t);break;case"setgroupuser":Emc.setcookie(o,t);break;case"setchannel":Emc.setcookie("emKefuChannel",i);break;case"dragready":m.style.display="block",s.style.display="none",EasemobWidget.utils.on(document,"mousemove",w);break;case"dragend":j()}}),e.easemobIM=function(t){if(EasemobWidget.utils.isMobile){var s=document.getElementById(o),n=e.event.srcElement||e.event.target;t?(n.setAttribute("href",s.getAttribute("src")+"&emgroup="+t),n.setAttribute("target","_blank")):(n.setAttribute("href",s.getAttribute("src")),n.setAttribute("target","_blank"))}else if(t){var a=Emc.getcookie(t);i.sendToIframe("emgroup@"+a+"@emgroupuser@"+t)}else i.sendToIframe("imclick")}},g=function(){if(s=/MSIE (6|7|8)/.test(navigator.userAgent)?document.createElement('<iframe name="'+(new Date).getTime()+'">'):document.createElement("iframe"),o="EasemobIframe"+(new Date).getTime(),s.id=o,s.name=(new Date).getTime(),s.frameBorder=0,s.allowTransparency="true",s.style.cssText=["z-index:16777269;","overflow:hidden;","position:fixed;","bottom:10px;","right:-5px;","border:none;","width:400px;","height:0;","display:none;","transition:all .01s;"].join(""),m.style.cssText=["display:none;","cursor:move;","z-index:16777270;","position:fixed;","bottom:10px;","right:10px;","border:none;","width:400px;","height:500px;","border-radius:4px;","box-shadow: 0 4px 8px rgba(0,0,0,.2);","border-radius: 4px;"].join(""),m.style.background="url("+f.domain+"/webim/static/img/drag.png) no-repeat",l="initdata:"+f.domain+"/webim/im.html?tenantId="+f.json.tenantId+(f.json.hide?"&hide=true":"")+(f.json.sat?"&sat=true":"")+(f.json.color?"&color="+f.json.color:"")+(f.json.preview?"&preview="+f.json.preview:"")+(n?"&c="+n:"")+(a?"&u="+a:"")+"&time="+(new Date).getTime(),s.src=f.domain+"/webim/im.html?tenantId="+f.json.tenantId,f.json.hide?(s.style.height="12px",s.style.width="12px"):(s.style.height="37px",s.style.width="104px"),EasemobWidget.utils.isMobile&&(s.style.cssText+="left:0;bottom:0",s.style.width="100%"),f.json&&f.json.preview){var e=document.getElementById(f.json.previewid);e?e.appendChild(s):document.body.appendChild(s)}else document.body.appendChild(m),document.body.appendChild(s);s.readyState?s.onreadystatechange=function(){("loaded"===s.readyState||"complete"===s.readyState)&&(this.style.display="block",i=new TransferMessage(o),h(),i.sendToIframe(l))}:s.onload=function(){this.style.display="block",i=new TransferMessage(o),h(),i.sendToIframe(l)}},b=document.createElement("script");b.src=f.domain+"/webim/static/js/easemob.utils.js",(document.head||document.getElementsByTagName("head")[0]).appendChild(b),b.readyState?b.onreadystatechange=function(){("loaded"==b.readyState||"complete"==b.readyState)&&x()}:b.onload=function(){x()};var x=function(){a=Emc.getcookie("emKefuUser"),n=Emc.getcookie("emKefuChannel"),g(),EasemobWidget.utils.on(m,"mouseup",j),E()},v=0,w=function(t){var i=(e.event||t,document.documentElement.clientWidth),s=document.documentElement.clientHeight,o=i-t.clientX-400+c.x,n=s-t.clientY-500+c.y;t.clientX-c.x<=0?o=i-400:t.clientX+400-c.x>=i&&(o=0),t.clientY-c.y<=0?n=s-500:t.clientY+500-c.y>=s&&(n=0),m.style.left="auto",m.style.top="auto",m.style.right=o+"px",m.style.bottom=n+"px",d={x:o,y:n},clearTimeout(v),v=setTimeout(j,500)},j=function(){EasemobWidget.utils.remove(document,"mousemove",w),s.style.left="auto",s.style.top="auto",s.style.right=d.x+"px",s.style.bottom=d.y+"px",m.style.left="auto",m.style.top="auto",m.style.right=d.x+"px",m.style.bottom=d.y+"px",m.style.display="none",s.style.display="block",setTimeout(function(){i.sendToIframe("dragend")},3e3)},E=function(){EasemobWidget.utils.on(e,"resize",function(){var e=document.documentElement.clientWidth,t=document.documentElement.clientHeight,i=Number(s.style.right.slice(0,-2)),o=Number(s.style.bottom.slice(0,-2));400>e?(s.style.left="auto",s.style.right=0,m.style.left="auto",m.style.right=0):400>e-i?(s.style.right=e-400+"px",s.style.left=0,m.style.right=e-400+"px",m.style.left=0):(s.style.left="auto",m.style.left="auto"),500>t?(s.style.top="auto",s.style.bottom=0):500>t-o?(s.style.bottom=t-500+"px",s.style.top=0):s.style.top="auto"})},T=function(){var t=0;return function(i,s,o){if(0===t){t=setTimeout(function(){t=0},3e3),i=i||"",s=s||"",o=o||"";try{if(e.Notification)if("granted"===Notification.permission){var n=new Notification(s,{icon:i,body:o});setTimeout(function(){n.close()},3e3)}else Notification.requestPermission()}catch(a){}}}}()}(window,void 0);